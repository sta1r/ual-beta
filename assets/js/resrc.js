/**
 * ReSRCit v0.6.0
 * http://www.resrc.it
 * Copyright (C) 2013 ReSRC Ltd.
 */(function(e,t,n){"use strict";function g(e,t){var n={};if(!t)return e;for(var r in e)r in t?n[r]=t[r]:n[r]=e[r];return n}function y(e){return e==1?"https://":"http://"}function b(e,t,r){var i=[];t==null&&(t=n);r==null&&(r="*");var s=t.getElementsByTagName(r),o=s.length,u=new RegExp("(^|\\s)"+e+"(\\s|$)"),a,f;for(a=0,f=0;a<o;a++)if(u.test(s[a].className)){i[f]=s[a];f++}return i}function w(e,t){var n=new Image;n.src=t;n.onload=function(){e.src=t}}function E(e,t){var n=new Image;n.src=t;n.onload=function(){e.style.backgroundImage="url("+t+")"}}function S(e,r){var i;e.currentStyle?i=e.currentStyle.getAttribute("backgroundImage"):t.getComputedStyle&&(i=n.defaultView.getComputedStyle(e,null).getPropertyValue(r));return i}function x(e){var t=n.createElement("a");t.href=e;return t.hostname}function T(e){var t=function(e){var t=d,n=[],r;while(r=t.exec(e))n.push(r[1]);return n};return t(e)}e.options=e.options||{};var r={resrcOnLoad:!0,resrcOnResize:!0,resrcOnPinch:!1,ssl:!1,resrcClass:"resrc",server:"app.resrc.it"},i=e.options,s=g(r,i),o=s.resrcOnLoad,u=s.resrcOnResize,a=s.resrcOnPinch,f=s.server,l=s.resrcClass,c=y(s.ssl),h=10,p=100,d=/\((.*?)\)/g,v,m=0;Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1});"filter"in Array.prototype||(Array.prototype.filter=function(e,t){var n=[],r;for(var i=0,s=this.length;i<s;i++)i in this&&e.call(t,r=this[i],i,this)&&n.push(r);return n});String.prototype.startsWith=function(e){return this.match("^"+e)==e};String.prototype.contains=function(e){return this.indexOf(e)>=0};String.prototype.trimStart=function(e){var t=this;while(t.startsWith(e))t=t.substring(1);return t};String.prototype.isNumber=function(){return!isNaN(parseFloat(this))&&isFinite(this)};Array.prototype.getItenIndexPosition=function(e){for(var t=0;t<this.length;t++)if(e==""){if(this[t]=="")return t}else{var n=new RegExp(e,["i"]),r=n.exec(this[t]);if(r!=null)return t}return-1};Array.prototype.removeItems=function(e){for(var t=0;t<this.length;t++)if(e==""){if(this[t]==""){this.splice(t,1);t--}}else{var n=new RegExp(e,["i"]),r=n.exec(this[t]);if(r!=null){this.splice(t,1);t--}}return this};var N,C,k,L,A,O,M,_,D,P,H,B,j,F;N=function(e){var t=e.getAttribute("data-resrc-gesture")||e.setAttribute("data-resrc-gesture","true");t||(e.addEventListener?e.addEventListener("gestureend",O,!1):e.attachEvent&&e.attachEvent("gestureend",O))},C=function(){o&&k()},k=function(){var e=b(l);for(var t=0;t<e.length;t++)L(e[t])},L=function(e,t){if(e!==null){t==null&&(t=1);typeof e[0]=="undefined"&&(e=[e]);for(var n=0;n<e.length;n++){var r=e[n];if(typeof r=="undefined"||r==null)return;var i=r.tagName.toLowerCase();if(i=="img"){var s=r.src;if(s)w(r,A(r,s,t,function(){a&&N(e[n])}));else{var o=r.getAttribute("data-src");r.setAttribute("src",A(r,o,t,function(){a&&N(r)}))}}else{var u=S(r,"background-image").replace(/url\(('?"?)(.*?)\1\)/gi,"$2");u!="none"&&E(r,A(r,u,t,function(){}))}}}},A=function(e,t,n,r){function w(e){var t=/\((.*?)\)/g;return t.test(e)}var i=M(e);i*=n;var s=t.replace(f,""),o,u,a;if(s.contains("//")){var l=s.lastIndexOf("//");o=s.substring(l+2);u=s.substring(0,l).toLowerCase();u=u.replace("/http:","").replace("http:","").replace("/https:","").replace("https:","");u=u.trimStart("/");a=u.split("/");a=a.removeItems("")}else{a=[];o=s}var d=D(e),v;i<p?v="s=w"+i+",pd"+d:v="s=w"+Math.ceil(i/h)*h+",pd"+d;var m=a.getItenIndexPosition("s="),g=a.getItenIndexPosition("o=.*");m!==-1?a.splice(m,1,v):g!==-1?a.splice(g,0,v):a.push(v);var b=a[a.getItenIndexPosition("o=.*")];if(w(b)){var E="o="+T(b);a.splice(g,1,E);a.join()}var S=c+f+"/"+a.join("/")+"/"+y(c)+o;e.setAttribute("data-resrc-width",i);r(S);return S},O=function(){var e=Math.round(screen.width/t.innerWidth*10)/10;w(event.target,A(event.target,event.target.src,e,function(){}))},M=function(e){if(e.getAttribute("data-resrc-width")!==null)return e.offsetWidth;var t,n,r={},i={position:"absolute",visibility:"hidden",display:"block"};for(n in i){r[n]=e.style[n];e.style[n]=i[n]}t=e.offsetWidth;for(n in i)e.style[n]=r[n];return t},_=function(){return t.devicePixelRatio?t.devicePixelRatio:1},D=function(e){var t=e.getAttribute("data-resrc-dpi")||"",n;t!=""?t.isNumber()?n=parseFloat(t):n=_():n=_();return n},F=function(){t.addEventListener?t.addEventListener("resize",P,!1):t.attachEvent&&t.attachEvent("onresize",P)},P=function(){m!==H()&&j()},H=function(){return n.documentElement.clientWidth||n.body&&n.body.clientWidth||1024},B=function(){k()};e.resrc=function(e,t){typeof e!="undefined"&&L(e,t)};e.resrcAll=function(){k()};j=function(){t.clearTimeout(v);v=t.setTimeout(B,250)};u&&F();if(t.addEventListener){t.addEventListener("DOMContentLoaded",function(){C();t.removeEventListener("load",C(),!1)},!1);t.addEventListener("load",C(),!1)}else t.attachEvent&&t.attachEvent("onload",function(){C()})})(this.resrc=this.resrc||{},this,document);